# 6.1 검증1 - Validation

## 6.1.1 BindingResult

스프링은 검증 오류 처리를 위해 `BindingResult`를 제공한다

```java
public String addItemV1(@ModelAttribute Item item, BindingResult bindingResult,
    RedirectAttributes redirectAttributes, Model model){

	//검증 로직
	if(!StringUtils.hasText(item.getItemName())){
	bindingResult.addError(new FieldError("item","itemName","상품 이름은 필수입니다."));
	}
    ...
}
```

`bindingResult`를 사용하면 각 에러에 맞는 값을 출력하기 위해 `Map` 객체를 생성하는 작업이 필요없다.
이 작업은 `bindingResult`가 알아서 해주기 때문이다.

또한 HTML 필드에서 일어나는 에러인 경우 `addError()`에 `FieldError`를 신규 생성해서 추가할 수 있다.
예시에서는 인자로 오브젝트 이름, 오류가 발생한 필드 이름, 에러 값을 받는다.

>**주의.**  
> `BindingResult`는 반드시 `@ModelAttribute Item item` 다음에 와야 한다.
> 이 오브젝트로부터 정보를 얻어오기 때문이다.

필드 에러가 아닌 사용자 정의 에러인 경우는 `new ObjectError()`를 사용해야 한다.

```java
bindingResult.addError(new ObjectError("item", "가격 * 수량의 합은 10,000원 이상이어야 합니다. 현재 값 = " + resultPrice));
```

### 타임리프 스프링 검증 오류 통합 기능

타임리프로 스프링의 `BindingResult`를 편리하게 사용할 수 있다.

- `#field` : `#field`로 `BindingResult`가 제공하는 검증 오류에 접근할 수 있다.
- `th:errors` : 해당 필드에 오류가 있는 경우에 태그를 출력한다.
- `th:errorclass` : `th:field`에 지정한 오류가 있으면 `class` 정보를 추가한다.


- `#field` 예시:
```html
<div th:if="${#fields.hasGlobalErrors()}">
  <p class="field-error" th:each="err: ${#fields.globalErrors()}" th:text="${err}">전체 오류 메시지</p>
</div>
```


- `th:errors`, `th:errrorclass`예시:
```html
<div>
  <label for="itemName" th:text="#{label.item.itemName}">상품명</label>
  <input type="text" id="itemName"
         th:errorclass="field-error" th:field="*{itemName}" class="form-control"
         placeholder="이름을 입력하세요">
  <div class="field-error" th:errors="*{itemName}">
    상품명 오류
  </div>
</div>
```

## 출처

> [인프런 강의 - 스프링 MVC 2편](https://www.inflearn.com/course/스프링-mvc-2/dashboard)